# AReaL 架构文档 - 更新版本

本目录包含AReaL系统的全面更新架构文档，重点关注清晰的可视化表示和详细的组件交互。

## 文档结构

### AReaLite架构文档

#### 📋 [AReaLite 概览](arealite_overview.md)
AReaLite的全面架构概览，风格类似于`gsm8k_grpo.md`示例。本文档提供：
- **系统架构图**: AReaLite组件的完整可视化表示
- **核心组件**: 每层和每个组件的详细说明
- **训练流程序列**: 逐步执行流程
- **算法实现**: GRPO与PPO的差异
- **性能特征**: 吞吐量、内存和通信分析
- **扩展点**: 如何自定义和扩展系统

#### 🔧 [AReaLite组件架构](component_architecture.md)
专注于组件交互和内部结构的详细架构视图：
- **组件交互架构**: 逐层依赖关系可视化
- **核心组件详情**: 类图和详细规范
- **数据流架构**: 数据如何在系统中流动
- **内存和通信模式**: FSDP2分片和SGLang负载均衡
- **配置架构**: 统一配置系统设计

#### 🔄 [AReaLite执行流程](execution_flows.md)
不同训练阶段的数据流和执行模式的综合视图：
- **完整训练循环流程**: 端到端训练过程
- **详细Rollout阶段流程**: 逐步rollout执行
- **GRPO训练阶段详情**: 算法特定的训练流程
- **权重同步流程**: 热权重更新过程
- **内存使用模式**: 内存分配和峰值使用分析
- **性能瓶颈分析**: 潜在问题和缓解策略

### Core架构文档

#### 🏢 [Core概览](core_overview.md)
Core系统的企业级分布式架构概览：
- **分布式系统架构**: 复杂的Master-Worker架构
- **MFC系统详解**: 模型函数调用抽象
- **同步/异步训练流程**: 两种训练模式的详细对比
- **通信架构**: 多层通信栈和优化策略
- **性能优化特性**: 企业级性能优化方案

#### 🏗️ [Core组件架构](core_component_architecture.md)
Core分布式组件的详细架构视图：
- **分布式组件交互**: 复杂的组件依赖关系
- **Worker节点架构**: Model Worker和Rollout Worker详解
- **MFC执行引擎**: 分布式函数调用机制
- **通信基础设施**: 多层通信协议栈
- **监控与调试**: 企业级监控体系

#### ⚡ [Core执行流程](core_execution_flows.md)
Core系统的复杂分布式执行管道：
- **分布式训练全流程**: 完整的分布式训练生命周期
- **MFC系统执行**: 模型函数调用的详细执行过程
- **容错与故障恢复**: 企业级容错机制
- **数据重分布系统**: 高效的数据分布策略
- **性能调优与监控**: 全方位的性能优化

### 系统对比

#### ⚖️ [架构对比分析](system_comparison.md)
AReaLite和Core架构的全面对比分析：
- **高层架构对比**: 可视化架构差异
- **关键差异摘要**: 主要方面的对比表
- **详细组件对比**: 算法和基础设施差异
- **性能特征**: 每个系统的优势和局限性
- **使用场景推荐**: 何时选择哪个系统
- **迁移路径**: 开发历程指导

## 关键设计改进

### 🎯 视觉优先方法
遵循`gsm8k_grpo.md`和开发者文档的风格：
- **丰富的Mermaid图表**: 复杂系统交互清晰可视化
- **分层架构视图**: 多层次抽象
- **基于流程的图表**: 过程流程和数据管道
- **对比可视化**: 并排系统比较

### 📊 全面覆盖
解决原始架构文档中的缺口：
- **算法澄清**: 清楚区分GRPO (AReaLite) 和 PPO (Core)
- **组件交互**: 详细的接口规范
- **性能分析**: 瓶颈、优化和权衡
- **实用指导**: 使用场景推荐和迁移路径

### 🔍 开发者友好的细节
受`docs/developer/`目录结构启发：
- **实现细节**: 类图和方法规范
- **内存模式**: FSDP2分片和通信优化
- **调试信息**: 性能瓶颈和监控点
- **扩展点**: 如何自定义和扩展组件

## 文档组织理念

### 分层信息架构
1. **概览层级** (`arealite_overview.md`): 高层系统理解
2. **组件层级** (`component_architecture.md`): 详细组件设计
3. **执行层级** (`execution_flows.md`): 运行时行为和数据流
4. **对比层级** (`system_comparison.md`): 跨系统分析

### 视觉一致性
- **颜色编码**: 所有图表的一致颜色方案
- **符号标准**: 标准化的形状和连接类型
- **抽象层级**: 高层和详细视图的清晰分离
- **流向**: 一致的数据流和控制流表示

## 如何使用本文档

### 新用户
1. 从**AReaLite概览**开始了解系统
2. 查看**系统对比**选择合适的架构
3. 深入**组件架构**了解实现细节
4. 使用**执行流程**进行调试和优化

### 开发者
1. 从**组件架构**开始了解接口规范
2. 学习**执行流程**理解运行时行为
3. 参考**系统对比**做架构决策
4. 使用**AReaLite概览**获取高层上下文

### 研究人员
1. 专注于概览中的**算法实现**部分
2. 研究**性能特征**寻找优化机会
3. 查看**扩展点**了解自定义可能性
4. 使用**对比分析**进行架构研究洞察

## 与原始文档的关系

### 保留内容
原始的`docs/architecture/`内容保持不变，提供：
- 历史架构决策
- 详细技术规范
- 遗留系统文档

### 增强内容
这份更新文档提供：
- **视觉清晰**: 丰富图表替代文字描述
- **完整流程**: 端到端过程文档
- **实用指导**: 使用场景和迁移建议
- **算法准确性**: 正确的GRPO vs PPO文档

### 互补价值
原始文档和更新文档一起提供：
- **多重视角**: 同一系统的不同视图
- **渐进细节**: 从高层概念到实现细节
- **历史背景**: 架构决策的演进
- **当前状态**: 当前系统的准确表示

## 未来文档演进

这个文档框架为以下方面提供基础：
- **增量更新**: 轻松添加新组件和功能
- **视觉一致性**: 新内容的标准化图表模板
- **交叉引用集成**: 不同架构视图间的链接
- **社区贡献**: 外部文档贡献的清晰结构

更新的架构文档代表了理解AReaL系统的全面、视觉优先方法，使不同背景和用例的用户都能轻松理解，同时保持技术准确性和实现细节。
